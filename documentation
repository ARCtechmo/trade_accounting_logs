*** Under Development ***

Section 1: Description
The documentation is  a guide to utilize the database and the set of python program files.
This is not a completely automated system and the program is specifically designed to work with specific broker 
data that must be dowloaded as .csv files directly from the broker's webseit.  This application is designed for 
FOREX.com, Interactive Brokers, and TD Ameritrade .csv files.    


Section 2: Installation Requirements
-This application requires Python3 and sqlite3 to be installed on your machine.  
-The sqlite DBbrowser is also recommended if you want to use a GUI. There are other sqlite GUIs available.   
-A text editor such as VSCode or VIM or EMACS (there are many others available) is required.

Section 3: Quickstart Guide

1. Create a directory (folder) where you will runn this application. 

2. Download the python files to the folder you created (or clone the repository).
-You need the following files: database.py, broker.py, database.py, export.py, fx.py, ib.py, td.py, time_logs.py
-Either clone the entire repository or open each file and save it to the directory (folder) you created.

3. Install python3.  
-Ensure you have python3 installed on your machine.  
-The method of installation varies depending on your system.  
-Python3 installer may give you an option to set the file path automatically. 
-Ensure that the $PATH is set so python will execute in the directory where you run this application. 

4. Install sqlite3 and the DBbrowser.  
-Again it is very important that you set your $PATH so sqlite3 and the DBbrowser will execute. 
-For most Linux systems sqlite3 is already installed.  For Windows and MacOS you will need to download and install sqlite3.
-For Windows ensure all of the python files and sqlite.exe files are in the same directory.
-The following links provide download and installation instructions for sqlite3 and the DBbrowser:  
-sqlite.org,sqlitetutorial.net, DBbrowser.org

5. Run the database.py file.
-The database.py file creates the database upon initial use.
-The database.py file also executes the queries on the database and therefore must be opened each time you run the application. 
-You must also manually close the database once you are finished.  It is not a good idea to leave the app open.
-You must manually open the database each time you run this application. 
-Open the database.py file in your text editor.
-Scroll to the last line of code where it says "conn.close()" and comment out this line. 
-Now tun the program in your terminal. 
-Navigate to your directory:
-For GNU/Linux systems  type "./python3 database.py"
-For Windows systems type "python database.py" 
-The database should now be open. 
-Check to ensure the database was successfully created with the GUI or in the terminal.  
-For GNU/Linus and Windows type "sqlite3" then type ".open database.db" then type .schema.  The db schema should appear.    
-Use the GUI. Use the sqlite DBbrowser you installed to open the database.db file.  There is a tab called "open database."

6. View / Modify the brokers.py file.  
-The brokers.py  file creates the foreign key relationships for the brokers and the activity types (e.g. trading, accounting, etc...).
-The first time you run this program you need to view and accept the defaults or modify them. 
-Use your text editor to open the brokers.py file.  
-There are two arrays (or lists) in the brokers.py file called "bk_name" and "activity_name".
-The numbers are the foreign keys and broker names or activity type.
-For instance, (3,FOREX_com) will assign the foreign key "3" to "FOREX_com" in the broker_id table.
-**Important** If you change a foreign key number then you will need to go into the corresponding python file to reflect that change.
-For example, if you change (3, "FOREX_com) to (1,"FORE_COM") then open the fx.py file, find the broker_id varialbe and change it (broker_id = 3 to broker_id = 2).
-You can alos modify the "activity_name" array in the brokers.py file by adding categories and / or modifying the numbers.  
-The FK relationships in the "activity_name" array are tied to the time_logs.py file.  You will need these foreign keys when you create time logs. 
-Now go to the terminal and run the "brokers.py" file.  
-In GNU / Linux type "python3 brokers.py".
-In Windows type "python brokers.py" .
-It it will prompt the user to establish the foreign key relatiionships.  select "y" for both.  
-Open the GUI and check the activity_log and brokers tables to ensure they tables conatain the foreign keys.     
     
7. Run the export.py file.   

Here is the process to utilize the file:
1. Log on to your broker account.
2. Select the the month and range (first day to last day) and get the data.
3. ***IMPORTANT*** Select the first and last day of the month.  Do not vary the data range.
4. Select .csv format and download the file to the same directory as the fx_dev_mode.py file.
5. ***IMPORTANT*** Select the broker number
     -  This number should match the foreign key in the "brokers" table of the database
     -  This number is tied to the foreign key relationships in the data and must be typed in correctly
     -  If you select the wrong number this will result in incorrect relations in the database



Bugs and workarounds
fx.py file timestamps and dates
-The fx.py files formats the dates.  
-Alpha testing revealed the program may return a '[]' in the HH:MM section of the dates or other incorrect date formats primarily in the HH:MM part.
-This is a minor bug that does not affect the ability of the program to run properly.  
-This bug will be corrected in future updates. 

fx.csv, fx.py and  export.py files
-This bug applies only to the trade transactions NOT commissions, financing, etc...
-The forex broker .csv files contain columns for close_id and open_id for the trade transactions. 
-Complete trade transactions have both a close_id and open_id and a single row. Incomplete trade transactions only have an open_id.
-The forex broker .csv files do not match the trade transactions so the functions in the fx.py and export.py files match the trade transactions.
-The vast majority of trade transactions in the forex broekr .csv files have unique close_ids and unique open_ids.
-However, there are some instances where two or more trade transactions may share an open_id.
-Testing during development and alpha testing revealed a bug when two or more trade transactions share an open_id.
-The program may fail to export some or even all rows of trade transactions that share an open_id.  
-When you run your SQL queries and compare the queries to the broker statements and your numbers do not match this is most likely the cause. 
-The problem is that the program will not export trade transactions that share an open_id with another row AND where there is no close_id.  
-Here is a quick fix.
-First, identify the missing trade transactions with the common open_ids (note it could be in two different months).
-Second, if the two trade transactions with the same open_ids are in the same .csv file create a new .csv file with a 'save as' (don't modify the original).
-Third, in the newly modified .csv file deelte all rows except the row with the missing close_id.
-So now the modified .csv file should only contain a row with the trade transaction and only an open_id (not the one with the open_id and close_id).
-Now run export.py on the modified .csv file.
-Next, run export.py on the .csv for the next month that contains the close_id for the trade transactions so the program will match them.
-There are other scenarios but basically it comes down to modifying the .csv file(s) to get the program to accept the data.  
-This only happens on a small percentage of cases.  
-This bug will be corrected in future updates.      

